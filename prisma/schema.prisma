// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

///////////////////////////////////////////////////////////////////////
// User
///////////////////////////////////////////////////////////////////////

model User{
  id           Int          @id @default(autoincrement())
  email        String       @unique
  password     String
  passwordSalt String?    
  name         String
  created      DateTime     @default(now())

  @@map("user")
}

///////////////////////////////////////////////////////////////////////
// AuthorizedOfficials
///////////////////////////////////////////////////////////////////////

model AuthorizedOfficials {
  id              Int       @id @default(autoincrement())
  name            String
  email           String    @unique
  contact_number  String    @unique @db.VarChar(10)
  cities          String

  password        String
  passwordSalt    String?    
  created         DateTime  @default(now())

  @@map("authorizedofficials")
}

///////////////////////////////////////////////////////////////////////
// TechTeam
///////////////////////////////////////////////////////////////////////

model TechTeam {
  id                Int       @id @default(autoincrement())
  name              String
  email             String?   @unique
  specialisation    String
  contact_number    String    @unique @db.VarChar(10)
  nr_jobs_completed Int?
  rating_of_jobs    Float?

  assigned_tickets  Ticket[]

  password          String
  passwordSalt      String?    
  created           DateTime  @default(now())

  @@map("techteam")
}

///////////////////////////////////////////////////////////////////////
// TechTeamTicket
///////////////////////////////////////////////////////////////////////

model TechTeamTicket {
  id                Int        @id @default(autoincrement())
  techteam_ID       Int
  ticket_ID         Int     

  @@map("techteamticket")
}

///////////////////////////////////////////////////////////////////////
// Ticket
///////////////////////////////////////////////////////////////////////

model Ticket {
  ticket_id           Int       @id @default(autoincrement())
  techTeam            TechTeam? @relation(fields: [assigned_TechTeam] , references: [id])
  assigned_TechTeam   Int?
  ticket_status       String
  ticket_create_date  DateTime    // @default(now())
  ticket_close_date   DateTime?
  ticket_type         String
  ticket_city         String?
  ticket_location     String    //place-id
  ticket_cost         Float?
  ticket_description  String
  ticket_repair_time  Int?
  ticket_upvotes      Int

  Picture             Picture[]
  @@map("ticket")
  
}

///////////////////////////////////////////////////////////////////////
// Picture
///////////////////////////////////////////////////////////////////////

model Picture {
  picture_id      Int     @id @default(autoincrement())
  picture_link    String
  ticket          Ticket  @relation(fields: [ticket_id], references: [ticket_id], onDelete: Cascade)
  ticket_id       Int

  @@map("picture")
}



