// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

///////////////////////////////////////////////////////////////////////
// User
///////////////////////////////////////////////////////////////////////

model User{
  id                  Int        @id @default(autoincrement())
  email               String     @unique
  password            String
  passwordSalt        String?    
  name                String
  created             DateTime

  @@map("user")
}

///////////////////////////////////////////////////////////////////////
// Ticket
///////////////////////////////////////////////////////////////////////

model Ticket {
  ticketId            Int       @id @default(autoincrement())
  ticketStatus        String
  ticketCreateDate    DateTime
  ticketCloseDate     DateTime?
  ticketType          String
  ticketCity          String?
  ticketLocation      String    //place-id
  ticketCost          Float?
  ticketDescription   String
  ticketRepairTime    Int?
  ticketUpvotes       Int

  Subtasks            Subtasks[]
  Picture             Picture[]

  @@map("ticket")
  
}

///////////////////////////////////////////////////////////////////////
// Subtasks
///////////////////////////////////////////////////////////////////////

model Subtasks{
  subtaskId         Int       @id @default(autoincrement())
  tickets           Ticket    @relation(fields: [ticketID], references: [ticketId], onDelete: Cascade)
  ticketID          Int
  taskDescription   String
  taskStep          String
  taskStatus        String

  @@map("subtasks")
}

///////////////////////////////////////////////////////////////////////
// Picture
///////////////////////////////////////////////////////////////////////

model Picture {
  pictureId         Int       @id @default(autoincrement())
  pictureLink       String
  ticket            Ticket    @relation(fields: [ticketID], references: [ticketId], onDelete: Cascade)
  ticketID          Int

  @@map("picture")
}

///////////////////////////////////////////////////////////////////////
// TechTeam
///////////////////////////////////////////////////////////////////////

model TechTeam {
  id                Int       @id @default(autoincrement())
  name              String
  email             String?   @unique
  specialisation    String
  contactNumber     String    @unique @db.VarChar(10)
  nrJobsCompleted   Int?
  ratingOfJobs      Float?

  password          String
  passwordSalt      String?    
  created           DateTime  @default(now())

  @@map("techteam")
}

///////////////////////////////////////////////////////////////////////
// TechTeamTicket
///////////////////////////////////////////////////////////////////////

model TechTeamTicket {
  id               Int        @id @default(autoincrement())
  techTeamId       Int
  ticketId         Int     

  @@map("techteamticket")
}

///////////////////////////////////////////////////////////////////////
// AuthorizedOfficials
///////////////////////////////////////////////////////////////////////

model AuthorizedOfficials {
  id              Int         @id @default(autoincrement())
  name            String
  email           String      @unique
  contactNumber   String      @unique @db.VarChar(10)
  cities          String

  @@map("authorizedofficials")
}
